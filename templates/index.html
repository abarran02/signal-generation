<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
    }
    input[type="text"], input[type="number"], input[type="range"] {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
    }
    .slider-value {
      text-align: right;
    }
  </style>
</head>
<body>

<h1>Data Form</h1>

<form id="dataForm" action="/generate/cw" method="get">
  <div class="form-group">
    <label for="sample_rate">Sample Rate (Hz):</label>
    <input type="text" id="sample_rate" name="sample_rate" value="1000" required pattern="\d+">
  </div>
  <div class="form-group">
    <label for="signal_length">Signal Length (s):</label>
    <input type="text" id="signal_length" name="signal_length" value="1" required pattern="\d+">
  </div>
  <div class="form-group" style="display:none;">
    <input type="text" id="form" name="form" value="sc16" required>
  </div>
  <button type="button" onclick="displayImage()">Show Waveform</button>
  <button type="submit">Download .sc16</button>
</form>

<img id="dynamicImage" style="display:none;">

<script>
  function displayImage(imageUrl) {
    // get all form data and serialize
    const form = document.getElementById('dataForm');
    const url = new URL(form.action);
    const params = new URLSearchParams(new FormData(form));
    params.set('form', 'png');

    // display image on page
    const imgElement = document.getElementById('dynamicImage');
    imgElement.src = `${url.pathname}?${params.toString()}`;
    imgElement.style.display = 'block';
  }
</script>

</body>
</html>
